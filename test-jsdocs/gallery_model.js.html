<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: portfolio/gallery_model.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: portfolio/gallery_model.js</h1>

    


    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>define(
  ['jquery', 'gallery_dao', 'messages', 'logger'],
  /**
* @exports gallery_model



*/
  function($, Dao, Messages, Logger) {
    'use strict';
    /** @alias module:gallery_model */
    /** @alias module:gallery_model */
    var exports = {};
    Messages.observe('gallery-data', Dao, exports);
    /**
     * Update.
     * @param observation
     * @param data
     */
    exports.update = function(observation, data) {
      Logger.fine('model update');
      this.items = data.items;
      this.items.reverse();
      this.items.sort(byTime);
      this.genres = getGenres(this.items);
      this.timeline = getTimeline(this.items);
      this.categories = getCategories(data.categories, this.genres);
      //console.log(this.timeline);
      //console.log(JSON.stringify(this));
      Messages.notify('gallery-model', this);
    };
    /**
     * Get timeline.
     * @param galleryData
     * @todo Please describe the return type of this method.
     * @return {Object} ??
     */
    function getTimeline(galleryData) {
      var timeline = {};
      for (var index = 0; index &lt; galleryData.length; index++) {
        var item = galleryData[index];
        if (timeline[item.date] == null) {
          timeline[item.date] = [];
        }
        timeline[item.date].push(item);
      }
      var output = [];
      for (var t in timeline) {
        if (timeline.hasOwnProperty(t)) {
          var tItem = {};
          tItem.date = t;
          tItem.events = timeline[t];
          output.push(tItem);
        }
      }
      output.sort(byTime);
      return output;
    }
    /**
     * Initialize.
     */
    exports.initialize = function() {
      Logger.fine('Model.initialize');
      Dao.fetch();
      Logger.fine('Model.initialize done');
    };
    /**
     * Get categories.
     * @param categories
     * @param genres
     * @todo Please describe the return type of this method.
     * @return {Object} ??
     */
    function getCategories(categories, genres) {
      var categoryData = [];
      for (var index = 0; index &lt; categories.length; index++) {
        var categoryName = categories[index];
        var item = {};
        item.index = index;
        item.name = categoryName;
        item.genres = getGenresForCategory(categoryName, genres);
        categoryData.push(item);
      }
      return categoryData;
    }
    /**
     * Decode html.
     * @param input
     * @todo Please describe the return type of this method.
     * @return {Object} ??
     */
    function decodeHtml(input) {
      var decoded = $("&lt;div/>").html(input).text();
      return decoded;
    }
    /**
     * By time.
     * @param b
     * @param a
     * @return {Number}
     */
    function byTime(b, a) {
      var dateA = new Date(a.date).getTime();
      var dateB = new Date(b.date).getTime();
      if (dateA > dateB) {
        return 1;
      } else if (dateB > dateA) {
        return -1;
      }
      return 0;
    }
    /**
     * Get genres for category.
     * @param categoryName
     * @param genres
     * @todo Please describe the return type of this method.
     * @return {Object} ??
     */
    function getGenresForCategory(categoryName, genres) {
      var output = [];
      for (var g in genres) {
        if (genres.hasOwnProperty(g)) {
          var genre = genres[g];
          genre.name = g;
          for (var index = 0; index &lt; genre.length; index++) {
            var genreItem = genre[index];
            //alert(decodeHtml(genreItem.tabCategory)+ "," + categoryName);
            if (decodeHtml(genreItem.tabCategory) === decodeHtml(categoryName)) {
              output.push(genreItem);
            }
          }
        }
      }
      output.sort(byTime);
      return output;
    }
    /**
     * Get genres.
     * @param galleryData
     * @todo Please describe the return type of this method.
     * @return {Object} ??
     */
    function getGenres(galleryData) {
      var genres = {};
      for (var index = 0; index &lt; galleryData.length; index++) {
        var item = galleryData[index];
        item.index = index;
        if (genres[item.industry] == null) {
          genres[item.industry] = [];
        }
        genres[item.industry].push(item);
      }
      return genres;
    }
    return exports;
  });</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Modules</h3><ul><li><a href="module-accountDetailsHeader.html">accountDetailsHeader</a></li><li><a href="module-browser_detect.html">browser_detect</a></li><li><a href="module-context.html">context</a></li><li><a href="module-depositAccounts.html">depositAccounts</a></li><li><a href="module-gallery_dao.html">gallery_dao</a></li><li><a href="module-gallery_model.html">gallery_model</a></li><li><a href="module-gallery_view.html">gallery_view</a></li><li><a href="module-info_panel.html">info_panel</a></li><li><a href="module-logger.html">logger</a></li><li><a href="module-messages.html">messages</a></li><li><a href="module-panel.html">panel</a></li><li><a href="contextual_carousel.html">portfolio/contextual_carousel</a></li><li><a href="module-slide_panel.html">slide_panel</a></li><li><a href="module-tab_panel.html">tab_panel</a></li><li><a href="module-tabs.html">tabs</a></li><li><a href="module-test.html">test</a></li><li><a href="module-thumbnail_panel.html">thumbnail_panel</a></li><li><a href="module-zero-test.html">zero-test</a></li></ul><h3>Classes</h3><ul><li><a href="module-accountDetailsHeader-AccountDetailsHeaderView.html">AccountDetailsHeaderView</a></li><li><a href="module-browser_detect-BrowserDetect.html">BrowserDetect</a></li><li><a href="context.html">module:fluffy/context</a></li><li><a href="context_ChildContext.html">ChildContext</a></li><li><a href="module-info_panel-InfoPanel.html">InfoPanel</a></li><li><a href="module-panel-Panel.html">Panel</a></li><li><a href="contextual_carousel-ContextualCarousel.html">ContextualCarousel</a></li><li><a href="module-slide_panel-SlidePanel.html">SlidePanel</a></li><li><a href="module-tab_panel-TabPanel.html">TabPanel</a></li><li><a href="module-tabs-Tabs.html">Tabs</a></li><li><a href="module-test-FifthClass.html">FifthClass</a></li><li><a href="module-test-FourthClass.html">FourthClass</a></li><li><a href="module-test-Freenox.html">Freenox</a></li><li><a href="module-test-SecondClass.html">SecondClass</a></li><li><a href="module-test-ThirdClass.html">ThirdClass</a></li><li><a href="module-thumbnail_panel-ThumbnailPanel.html">ThumbnailPanel</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha9</a> on Tue Nov 11 2014 18:40:40 GMT-0500 (EST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
